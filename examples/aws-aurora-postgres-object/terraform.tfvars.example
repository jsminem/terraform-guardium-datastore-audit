# =====================================================================
# AWS CONFIGURATION - CRITICAL
# =====================================================================
# REQUIRED: Your AWS region - MUST match where your Aurora PostgreSQL cluster is deployed
aws_region = "us-east-1"  # CHANGE THIS to your actual AWS region (e.g., "us-west-2")

# The identifier of your Aurora PostgreSQL cluster (found in RDS console)
aurora_postgres_cluster_identifier = ""

# Whether to force a failover when applying parameter changes (requires Multi-AZ)
force_failover = false

# =====================================================================
# DATABASE CONNECTION DETAILS - CRITICAL
# =====================================================================
# REQUIRED: The endpoint address of your Aurora PostgreSQL cluster WITHOUT the port
# This is the "Endpoint" value from the RDS console, without the ":5432" part
# Example: "my-cluster.cluster-abcdefg.us-west-2.rds.amazonaws.com"
db_host = ""

# The port your PostgreSQL database is listening on (usually 5432)
db_port = 5432

# REQUIRED: Master username for your PostgreSQL database
db_username = "postgres_admin"

# REQUIRED: Master password for your PostgreSQL database
db_password = "YourSecurePassword123!"

# The name of the database to connect to (default is "postgres")
db_name = "postgres"

# SSL mode for PostgreSQL connection (options: disable, prefer, require, verify-ca, verify-full)
ssl_mode = "prefer"

# =====================================================================
# GUARDIUM CONFIGURATION - CRITICAL
# =====================================================================
# Name for the Universal Connector (used for AWS resource naming)
udc_name = "aurora-postgres-audit-connector"

# REQUIRED: Name of the AWS credential defined in Guardium
# This must match a credential you've already created in Guardium
udc_aws_credential = "aws-guardium-credential"

# REQUIRED: Guardium server hostname/IP and connection details
gdp_server = "guardium.example.com"
gdp_port = "8443"
gdp_username = "admin"                 # Replace with your Guardium username
gdp_password = "password"              # Replace with your Guardium password

# REQUIRED: OAuth client credentials for Guardium API access
# These are obtained by running the "grdapi register_oauth_client" command
gdp_client_id = "client4"              # Replace with your client ID
gdp_client_secret = "client-secret"    # Replace with your client secret

# Comma-separated list of Guardium Managed Units to deploy the profile to
gdp_mu_host = "mu1.guardium.example.com,mu2.guardium.example.com"


# =====================================================================
# UNIVERSAL CONNECTOR CONFIGURATION
# =====================================================================
# Whether to enable the Universal Connector (set to false to disable)
enable_universal_connector = true

# Start position for log processing: "beginning" or "end"
# - "beginning": Process all available logs (may cause high initial load)
# - "end": Process only new logs going forward
csv_start_position = "end"

# Polling interval in seconds for checking new logs
csv_interval = "15"

# Event filter for Universal Connector (leave empty for no filtering)
csv_event_filter = ""

# Log export type: "SQS" or "Cloudwatch"
# - "SQS": Use Amazon SQS for log delivery (more real-time)
# - "Cloudwatch": Use CloudWatch Logs for log delivery (more reliable)
log_export_type = "Cloudwatch"

# Optional: Custom endpoint URL for AWS CloudWatch (leave empty to use default AWS endpoint)
# cloudwatch_endpoint = ""

# Optional: Whether to use the AWS bundled CA certificates for CloudWatch connection (default: true)
# use_aws_bundled_ca = true



# =====================================================================
# TABLE GRANTS CONFIGURATION - OBJECT-LEVEL AUDITING
# =====================================================================
# List of tables to monitor with specific grants
# For each table, specify:
# - schema: The schema name (e.g., "public")
# - table: The table name (e.g., "users")
# - grants: List of operations to audit (SELECT, INSERT, UPDATE, DELETE, etc.)
tables = [
  {
    schema = "public"
    table  = "users"
    grants = ["SELECT", "INSERT", "UPDATE", "DELETE"]  # Audit all operations on users table
  },
  {
    schema = "public"
    table  = "orders"
    grants = ["SELECT", "INSERT", "UPDATE"]  # Don't audit DELETE operations
  },
  {
    schema = "accounting"
    table  = "transactions"
    grants = ["SELECT"]  # Only audit SELECT operations (read-only)
  }
]