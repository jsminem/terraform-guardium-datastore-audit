# AWS MySQL RDS with IBM Guardium Data Protection - Terraform Variables

#----------------------------------------
# General Configuration
#----------------------------------------
aws_region = "us-east-1"
tags = {
  Environment = "Demo"
  Owner       = "Security"
  Project     = "Guardium-Terraform"
}

#----------------------------------------
# MySQL RDS Configuration
#----------------------------------------
mysql_rds_cluster_identifier = "your-mysql-instance"
force_failover = false

#----------------------------------------
# Audit Configuration
#----------------------------------------
audit_events = "CONNECT,QUERY"
audit_file_rotations = "10"
audit_file_rotate_size = "1000000"
audit_incl_users = ""  # Comma-separated list of users to include (empty = audit all users)
audit_excl_users = "rdsadmin"  # Comma-separated list of users to exclude (rdsadmin recommended to reduce log volume)
audit_query_log_limit = "1024"  # Maximum query length in bytes (queries longer than this will be truncated)
# List of log types to export to CloudWatch. Valid values for MySQL: audit, error
# The Guardium plugin processes audit logs and "Login Failed" error logs
cloudwatch_logs_exports = ["audit", "error"]
log_export_type = "Cloudwatch"
cloudwatch_endpoint = ""  # Custom endpoint URL for AWS CloudWatch (leave empty to use default AWS endpoint)
use_aws_bundled_ca = true  # Whether to use the AWS bundled CA certificates for CloudWatch connection

#----------------------------------------
# Universal Connector Configuration
#----------------------------------------
enable_universal_connector = true
udc_name = "mysql-gdp"
udc_aws_credential = "guardium-aws"  # Name of the AWS credential stored in Guardium Central Manager

# CSV Configuration
csv_start_position = "end"
csv_interval = "5"
csv_event_filter = ""

#----------------------------------------
# Guardium Connection Details
#----------------------------------------
gdp_server             = "guardium.example.com"  # Replace with your Guardium server
gdp_port               = 8443
gdp_username           = "admin"                 # Replace with your Guardium username
gdp_password           = "password"              # Replace with your Guardium password
gdp_client_id          = "client4"               # Replace with your client ID
gdp_client_secret      = "client-secret"         # Replace with your client secret
gdp_mu_host            = ""                      # Comma separated list of Guardium Managed Units
