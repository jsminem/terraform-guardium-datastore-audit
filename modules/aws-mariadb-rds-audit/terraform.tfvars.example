###############################################################################
# AWS MariaDB RDS Audit Configuration - Terraform Variables
###############################################################################

#------------------------------------------------------------------------------
# AWS Configuration
#------------------------------------------------------------------------------

# AWS region where the MariaDB RDS instance is located
aws_region = "us-east-1"

# The identifier of the MariaDB RDS instance to be monitored
mariadb_rds_cluster_identifier = "your-mariadb-instance"

# Major version of MariaDB (e.g., '10.6')
# This is required to select the appropriate parameter group family
mariadb_major_version = "10.6"

# Optional: Set to true to force a failover during parameter group update
# Only applicable for multi-AZ deployments, will cause minimal downtime
# force_failover = false

# Optional: Add tags to resources created by this module
# tags = {
#   Environment = "Production"
#   Project     = "Database Security"
#   Owner       = "Security Team"
# }

#------------------------------------------------------------------------------
# Guardium Data Protection (GDP) Configuration
#------------------------------------------------------------------------------

# Name of the AWS credential defined in Guardium
# This credential must have permissions to access CloudWatch logs
udc_aws_credential = "aws-credential-name"

# Client secret from output of grdapi register_oauth_client command
gdp_client_secret = "client-secret"

# Client ID used when running grdapi register_oauth_client
gdp_client_id = "client-id"

# Hostname or IP address of the Guardium Central Manager
gdp_server = "guardium-server.example.com"

# Optional: Port of Guardium Central Manager (default: 8443)
# gdp_port = "8443"

# Username for Guardium Web UI access
gdp_username = "guardium-user"

# Password for Guardium Web UI access
gdp_password = "guardium-password"

# Guardium OS user with SSH access
gdp_ssh_username = "guardium-ssh-user"

# Path to the private SSH key for connecting to Guardium OS
gdp_ssh_privatekeypath = "/path/to/private/key"

# Optional: Comma-separated list of Guardium Managed Units to deploy profile
# Leave empty to use the default Managed Unit
# gdp_mu_host = ""

#------------------------------------------------------------------------------
# Audit Configuration
#------------------------------------------------------------------------------

# Type of log export mechanism to use: "Cloudwatch" or "SQS"
# Cloudwatch is recommended for most deployments
log_export_type = "Cloudwatch"

# Comma-separated list of events to audit
# Available options:
# - CONNECT: Connection events
# - QUERY: All queries
# - TABLE: Table access events
# - QUERY_DDL: Data Definition Language queries
# - QUERY_DML: Data Manipulation Language queries
# - QUERY_DCL: Data Control Language queries
audit_events = "CONNECT,QUERY"

# Optional: Number of audit file rotations to keep (default: 10)
# audit_file_rotations = "10"

# Optional: Size in bytes before rotating audit file (default: 1000000)
# audit_file_rotate_size = "1000000"

# Optional: Set to false to include rdsadmin health check queries in audit logs
exclude_rdsadmin_user = true

#------------------------------------------------------------------------------
# Universal Connector Configuration
#------------------------------------------------------------------------------

# Optional: Name for universal connector (default: mariadb-gdp)
# This name is used for all AWS objects created by the connector
# udc_name = "mariadb-gdp"

# Optional: Whether to enable the universal connector (default: true)
# Set to false to completely disable the universal connector
# enable_universal_connector = true

# Optional: Start position for Universal Data Connector (default: end)
# Options: "start" (beginning of logs) or "end" (only new logs)
# csv_start_position = "end"

# Optional: Polling interval in seconds for Universal Data Connector (default: 5)
# csv_interval = "5"

# Optional: Event filters for Universal Data Connector
# csv_event_filter = ""
